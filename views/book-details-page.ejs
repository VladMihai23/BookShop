<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">

    <title><%= book.title %> | Book Details | BookShop</title>

    <meta name="description" content="<%= book.description ? book.description.substring(0, 160) : '' %>">

    <meta property="og:title" content="<%= book.title %> | BookShop">
    <meta property="og:description" content="<%= book.description ? book.description.substring(0, 160) : '' %>">
    <meta property="og:image" content="<%= book.image_url %>">
    <meta property="og:type" content="product">
    <meta property="og:url" content="http://localhost:3000/books/<%= book.slug %>">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="<%= book.title %> | BookShop">
    <meta name="twitter:description" content="<%= book.description ? book.description.substring(0, 160) : '' %>">
    <meta name="twitter:image" content="<%= book.image_url %>">

    <link rel="canonical" href="http://localhost:3000/books/<%= book.slug %>">

    <script type="application/ld+json">
        {
          "@context": "https://schema.org/",
          "@type": "Product",
          "name": "<%= book.title %>",
      "image": ["<%= book.image_url %>"],
      "description": "<%= (book.description || '').replace(/\"/g, '\'').substring(0, 200) %>",
      "brand": {
        "@type": "Brand",
        "name": "<%= book.author %>"
      },
      "offers": {
        "@type": "Offer",
        "url": "http://localhost:3000/books/<%= book.slug %>",
        "priceCurrency": "USD",
        "price": "<%= book.price %>",
        "availability": "https://schema.org/InStock",
        "itemCondition": "https://schema.org/NewCondition"
      }
    }
    </script>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/style.css">
</head>

<body class="bg-light">

<header>
    <%- include('navbar'); %>
</header>

<div class="container py-5">

    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="/">Home</a></li>
            <li class="breadcrumb-item active" aria-current="page"><%= book.title %></li>
        </ol>
    </nav>

    <div class="row justify-content-center">
        <div class="col-lg-10">

            <div class="card shadow-sm p-4">

                <div class="row">

                    <div class="col-md-4 text-center">
                        <img src="<%= book.image_url %>"
                             alt="<%= book.title %> book cover"
                             class="img-fluid rounded shadow">
                    </div>

                    <div class="col-md-8">

                        <h2><%= book.title %></h2>
                        <h4 class="text-muted">by <%= book.author %></h4>

                        <p><strong>Genre:</strong> <%= book.genre %></p>
                        <p><strong>Price:</strong> $<%= book.price %></p>

                        <h5 class="mt-4">Description:</h5>
                        <p><%= book.description || "No description available." %></p>

                        <% if (session.user && session.user.role === 'user') { %>
                            <form action="/cart/add/<%= book.id %>" method="POST">
                                <button class="btn btn-success mt-3 w-100">
                                    <i class="bi bi-cart-plus"></i> Add to Cart
                                </button>
                            </form>
                        <% } %>

                        <% if (!session.user) { %>
                            <a href="/user" class="btn btn-outline-primary mt-3 w-100">
                                Login to Add to Cart
                            </a>
                        <% } %>

                        <% if (session.user && session.user.role === 'admin') { %>
                            <a href="/admin/books/edit/<%= book.id %>" class="btn btn-warning mt-3 w-100">
                                Edit Book
                            </a>
                        <% } %>

                        <% if (session.user && session.user.role === 'user') { %>
                            <form action="/wishlist/add/<%= book.id %>" method="POST">
                                <button class="btn btn-outline-danger w-100 mt-3">
                                    ❤️ Add to Wishlist
                                </button>
                            </form>
                        <% } %>


                        <a href="/" class="btn btn-secondary mt-3 w-100">← Back to Home</a>

                    </div>
                </div>

            </div>

        </div>
    </div>

</div>

<footer class="text-center py-4">
    © 2025 - Piriia Vlad-Mihai
</footer>

</body>
</html>
